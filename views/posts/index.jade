extends ../layout

block scripts
  script(src="/javascripts/posts/pages/index.js")

block content
  include new-post-editor

  #posts-list
    - for entry in posts
      include entry-pjax

  #posts-loading
    .icon.loading.right

block template
  script#template-remove-post(type='jst')
    p.clearfix Are you sure?
    br
    p(style="text-align:center;")
      span.btn(onclick="posts.list.remove('{{ id }}');$('#rm-{{ id }}').popover('hide');") Yes
      &nbsp;
      a.btn.btn-primary(onclick="$('#rm-{{ id }}').popover('hide');") No
  script#template-modify-post(type='jst')
    .editor
      include editor-bar-outer
      form(method="post", name="modifypost")
        textarea(placeholder="Say something", name="content",
        style="width:100%"){{ revisions[revisions.length - 1].content }}
        .clearfix.editor-bar
          include editor-bar
        .clearfix
          .right
            input.btn.btn-primary(type="submit", value="Modify")
          input(name="message", placeholder="commit message")
          input(name="title", type="hidden", value="{{ entry.title }}")
        .preview {{{ html }}}

  script#template-comment(type='jst')
    include comment
  script#template-comment-form(type='jst')
    // TODO simplfy this
    .row
      .avatar-info
        .avatar
          // FIXME this will load an non exists image
          a.avatar(href="#", style="background-image:url('{{ user.avatar }}')", title="Jason's blog")
      .span9
        form(action='/post/{{ id }}/comments/{{ operation }}', method='post')
          textarea(name="content", style="width:100%")
          input.btn.btn-primary(type="submit", value="comment")
